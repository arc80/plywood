library platform {
    config_options {
        with_asserts = false
    }
    source_files {
        "ply-platform"
    }
    include_directories {
        public "."
        public join_path(sys.build_folder, "codegen/ply-platform")
    }
    preprocessor_definitions {
        if with_asserts {
            public "PLY_WITH_ASSERTS=1"
        }
    }
    generate {
        src = """
#define PLY_WITH_EXCEPTIONS 0
#define PLY_CMAKE_PATH "${escape(sys.cmake_path)}"
"""
        save_if_different(join_path(sys.build_folder,
                                    "codegen/ply-platform/ply-platform/Config.h"), src)
    }
}
